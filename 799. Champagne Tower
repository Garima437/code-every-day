class Solution {

    Double[][] dp;

    public double champagneTower(int poured, int query_row, int query_glass) {

        dp = new Double[query_row + 1][query_row + 1];

        return Math.min(1.0, solve(poured, query_row, query_glass));
    }

    private double solve(int poured, int i, int j) {

        if (j < 0 || j > i) return 0.0;

        if (i == 0 && j == 0) return poured;

        if (dp[i][j] != null) return dp[i][j];

        double leftup = Math.max(0.0, solve(poured, i - 1, j - 1) - 1) / 2.0;
        double rightup = Math.max(0.0, solve(poured, i - 1, j) - 1) / 2.0;

        dp[i][j] = leftup + rightup;

        return dp[i][j];
    }
}
