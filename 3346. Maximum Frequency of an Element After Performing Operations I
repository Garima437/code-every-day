class Solution {
    public int maxFrequency(int[] nums, int k, int numOperations) {
         int maxele=0;
        for(int i:nums){
            maxele=Math.max(maxele,i);
        }
        int[] freq=new int[maxele+k+2];
        Arrays.fill(freq,0);
        for(int i:nums){
            freq[i]++;
        }
        for(int i=1;i<=maxele;i++){
            freq[i]+=freq[i-1];
        }
        int res=0;
        for(int tar=0;tar<=maxele+k;tar++){
            if(freq[tar]==0) continue;
            int leftnum=Math.max(0,tar-k);
            int rightnum=Math.min(maxele,tar+k);
            int totalcount=freq[rightnum]-(leftnum>0?freq[leftnum-1]:0);
            int tarcount=freq[tar]-(tar>0?freq[tar-1]:0);
            int needcon=totalcount-tarcount;
            int maxposs=tarcount+Math.min(needcon,numOperations);
            res=Math.max(res,maxposs);
        }
        return res;
    }
}
